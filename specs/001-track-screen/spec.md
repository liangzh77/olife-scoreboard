# 功能规格说明: 赛场信息屏幕 (Track Screen)

**功能分支**: `001-track-screen`
**创建日期**: 2025-12-24
**状态**: 草稿
**输入**: 原始需求.md - 赛场信息屏幕需求书

## 澄清记录

### Session 2025-12-24

- Q: 应用退出后重新启动时，配置参数是否需要保留？ → A: 持久化保存 - 所有配置参数在应用重启后保留
- Q: 每个赞助商LOGO全屏展示时应停留多长时间？ → A: 在设置页面可配置
- Q: 多个组别轮播时，按什么顺序展示？ → A: 按开始时间排序，未开始的组别不参与轮播

## 用户场景与测试 *(必填)*

### 用户故事 1 - 配置赛事并启动展示 (优先级: P1)

作为赛事管理员，我需要在应用启动后配置要展示的赛事和组别，然后启动滚动播放，以便向观众展示实时赛事信息。

**优先级原因**: 这是应用的核心入口功能，没有配置功能就无法使用整个应用。

**独立测试**: 可以通过启动应用、选择赛事和组别、点击开始按钮来完整测试，验证能否进入滚动播放模式。

**验收场景**:

1. **Given** 应用刚启动, **When** 系统加载完成, **Then** 自动显示配置页面，展示版本号、网络状态、设备IP、数据源URL
2. **Given** 在配置页面, **When** 系统成功连接数据源, **Then** 左侧显示可用的赛事列表
3. **Given** 选中一个赛事, **When** 点击该赛事, **Then** 右侧显示该赛事的所有组别，支持多选
4. **Given** 已选择一个或多个组别, **When** 点击"开始"按钮, **Then** 进入滚动播放页面
5. **Given** 在配置页面, **When** 点击"退出"按钮, **Then** 应用退出

---

### 用户故事 2 - 查看组别成绩滚动播放 (优先级: P1)

作为观众或参赛者，我需要在大屏幕上查看各组别的实时成绩排名，以便了解比赛进展和自己的名次。

**优先级原因**: 这是产品的核心价值功能，直接服务于最终用户（观众和参赛者）。

**独立测试**: 可以通过配置好赛事后观察成绩展示效果，验证数据显示、分栏布局、分页切换是否正常。

**验收场景**:

1. **Given** 进入滚动播放模式, **When** 有成绩数据, **Then** 页面上方显示赛事名称和当前组别名称
2. **Given** 成绩列表展示中, **When** 查看运动员信息, **Then** 显示名次、号码布、国籍、姓名、出发时间、完赛用时、与第一名时间差、评估结果
3. **Given** 成绩数据超过一屏, **When** 需要展示更多数据, **Then** 自动分栏显示（纵向多栏）
4. **Given** 分栏后仍显示不下, **When** 需要分页, **Then** 自动分页，每页停留配置的时间后切换，切换有平滑过渡动画
5. **Given** 当前组别所有页面展示完毕, **When** 还有其他选中的组别, **Then** 平滑切换到下一个组别继续展示

---

### 用户故事 3 - 查看实时事件跑马灯 (优先级: P2)

作为观众，我需要在屏幕底部看到实时事件通知，以便及时了解新出发、新完成、新进入前三名等重要事件。

**优先级原因**: 增强用户体验，提供实时动态信息，但不影响核心成绩展示功能。

**独立测试**: 可以在有新事件发生时观察跑马灯是否正确显示相关信息。

**验收场景**:

1. **Given** 滚动播放页面底部, **When** 有运动员新出发（第一次出现实时数据）, **Then** 跑马灯显示"XXX已出发"（从右向左滚动一次）
2. **Given** 滚动播放页面底部, **When** 有运动员新完成比赛, **Then** 跑马灯显示"XXX已完成比赛"
3. **Given** 滚动播放页面底部, **When** 前三名排名发生变化, **Then** 跑马灯显示"XXX获得第X名"

---

### 用户故事 4 - 赞助商LOGO轮播 (优先级: P2)

作为赛事组织方，我需要在成绩展示间隙展示赞助商LOGO，以满足商业合作需求。

**优先级原因**: 商业价值功能，但不影响核心赛事信息展示。

**独立测试**: 可以配置LOGO轮播频次后观察是否按设定间隔全屏展示赞助商LOGO。

**验收场景**:

1. **Given** 滚动播放进行中, **When** 组别轮播达到配置的频次, **Then** 全屏展示一个赞助商LOGO
2. **Given** 展示赞助商LOGO, **When** 展示时间结束, **Then** 返回成绩展示，下次展示下一个LOGO

---

### 用户故事 5 - 调整展示参数 (优先级: P3)

作为赛事管理员，我需要根据现场屏幕大小和观看距离调整字体大小、分栏数量等参数，以确保最佳观看效果。

**优先级原因**: 优化体验的辅助功能，有合理默认值可用。

**独立测试**: 可以在配置页面修改参数后观察展示效果变化。

**验收场景**:

1. **Given** 在配置页面, **When** 修改"每页停留时间"参数, **Then** 滚动播放时按新设置的时间切换页面
2. **Given** 在配置页面, **When** 修改"字体大小"参数, **Then** 成绩展示使用新的字体大小
3. **Given** 在配置页面, **When** 修改"分栏数量"参数, **Then** 成绩展示按新设置的栏数布局
4. **Given** 在配置页面, **When** 修改"赞助商LOGO轮播频次", **Then** 按新频次展示LOGO

---

### 用户故事 6 - 从滚动播放返回配置 (优先级: P3)

作为赛事管理员，我需要在滚动播放过程中能够返回配置页面，以便切换赛事或调整参数。

**优先级原因**: 运维管理功能，确保管理员可以随时调整。

**独立测试**: 可以在滚动播放时测试隐藏按钮的显示和返回功能。

**验收场景**:

1. **Given** 滚动播放页面, **When** 鼠标/手指靠近右上角, **Then** 显示隐藏的设置按钮
2. **Given** 设置按钮可见, **When** 点击设置按钮, **Then** 退出滚动播放，返回配置页面

---

### 边界情况

- 网络断开时如何处理？显示最后获取的数据，并在界面上提示网络状态异常
- 数据源返回空数据时如何处理？显示"暂无数据"提示
- 只选择一个组别时如何处理？正常展示该组别，无需切换动画
- 赞助商LOGO列表为空时如何处理？跳过LOGO展示环节
- 某组别无成绩数据时如何处理？跳过该组别，展示下一个有数据的组别

## 需求 *(必填)*

### 功能需求

**配置页面**

- **FR-001**: 系统必须在启动时自动进入配置页面
- **FR-002**: 配置页面必须显示版本号、网络连接状态、设备IP地址、数据源URL、最后更新时间
- **FR-003**: 配置页面必须提供赛事列表（从数据源获取）
- **FR-004**: 用户必须能够选择一个赛事后查看该赛事的组别列表
- **FR-005**: 用户必须能够多选组别用于轮播展示
- **FR-006**: 系统必须提供以下可配置参数：
  - 每页停留时间（默认30秒）
  - 赞助商LOGO轮播频次（每多少轮组别后展示一次）
  - 赞助商LOGO展示时长（每个LOGO停留的秒数）
  - 字体大小
  - 分栏数量
- **FR-007**: 配置页面必须提供"开始"按钮进入滚动播放
- **FR-008**: 配置页面必须提供"退出"按钮退出应用
- **FR-019**: 系统必须持久化保存所有配置参数（数据源URL、每页停留时间、字体大小、分栏数量、赞助商LOGO轮播频次、赞助商LOGO展示时长），应用重启后自动恢复上次配置

**滚动播放页面**

- **FR-009**: 滚动播放页面必须在顶部显示赛事名称和当前组别名称
- **FR-010**: 成绩列表必须显示运动员的：名次、号码布、国籍、姓名、出发时间、完赛用时、与第一名时间差、评估结果
- **FR-011**: 成绩列表必须支持纵向分栏显示（栏数可配置）
- **FR-012**: 成绩超过一屏时必须自动分页，页面切换必须有平滑过渡动画
- **FR-013**: 组别切换时必须有平滑过渡动画
- **FR-020**: 组别轮播必须按开始时间排序，未开始的组别不参与轮播
- **FR-014**: 系统必须按配置的频次在组别轮播间隙全屏展示赞助商LOGO
- **FR-015**: 页面底部必须显示事件跑马灯，内容包括新出发、新完成、新进入前三名
- **FR-016**: 滚动播放页面右上角必须有隐藏的设置按钮（鼠标/手指靠近时显示），点击可返回配置页面

**数据获取**

- **FR-017**: 系统必须通过HTTP API获取赛事数据，数据刷新频率不低于60秒一次
- **FR-018**: 系统必须支持配置数据源URL（测试环境和正式环境）

### 关键实体

- **赛事 (Event)**: 一场比赛活动，包含名称、多个组别
- **组别 (Course)**: 赛事中的一个分组，包含名称、参赛运动员列表
- **运动员成绩 (Competitor Result)**: 包含名次、号码布、国籍、姓名、出发时间、完赛用时、与第一名时间差、评估结果
- **赞助商 (Sponsor)**: 包含LOGO图片URL
- **事件 (Event Notification)**: 新出发、新完成、排名变化等实时事件

## 成功标准 *(必填)*

### 可衡量的成果

- **SC-001**: 管理员可以在2分钟内完成赛事配置并启动展示
- **SC-002**: 成绩数据更新后，屏幕在60秒内显示最新数据
- **SC-003**: 页面切换和组别切换动画流畅，无明显卡顿
- **SC-004**: 在标准观看距离（5-10米）下，成绩信息清晰可读
- **SC-005**: 系统支持连续运行8小时以上不出现异常
- **SC-006**: 跑马灯事件在发生后60秒内显示
- **SC-007**: 色觉障碍用户可以准确识别关键信息（不依赖颜色区分）

## 假设

- 数据源API稳定可用，返回格式符合JSON规范
- 运行设备具备稳定的网络连接
- 显示设备支持HDMI输入且分辨率不低于1920×1080
- 赞助商LOGO图片URL由API提供（API待定）
- 默认每页停留时间30秒能满足大多数场景
- 默认字体大小和分栏数量适合常见的展示场景

## 开发策略

### 界面优先原则

采用"先界面，后功能"的开发顺序：

1. **第一阶段：界面开发** - 完成所有页面的 UI 布局和视觉效果
2. **第二阶段：界面确认** - 与用户确认界面设计符合预期
3. **第三阶段：功能开发** - 在确认的界面基础上实现业务逻辑

**原因**：界面是用户最直接感知的部分，先确认界面可以避免后期大量返工。

### 平台开发顺序

采用"先 H5，后安卓"的跨平台开发策略：

1. **H5 开发阶段** - 在浏览器中开发和调试所有功能
2. **H5 验证阶段** - 验证界面和交互逻辑正确
3. **安卓适配阶段** - 在安卓真机上测试，处理平台差异
4. **APK 打包阶段** - 最终打包发布

**原因**：
- H5 开发效率高，热更新快，浏览器调试工具强大
- uni-app 设计理念就是"一次开发，多端发布"
- 先验证逻辑正确性，再处理平台适配问题

### 跨平台注意事项

- 使用 `rpx` 单位确保多端适配
- 避免使用仅 H5 支持的特性（如直接操作 `window` 对象）
- 平台差异代码使用条件编译 `#ifdef APP-PLUS` 处理
- 定期在安卓真机上验证，避免最后集中处理大量问题
